# Leflair Code Challenge

# <img src="/images/demo.png?raw=true">

The leflair test using the setup generated by create-react-app alongside a Node Express API server.


## Requirements

View [Requirements file](./requirementss.md).

## Design

### Database
![](./images/database-design.png)

### Architecture

#### Microservices
![](./images/microservices.png)

#### Server side rendering
![](./images/server-side-rendering.png)


## API Doc

View [Swagger YAML file](./server/swagger.yaml).

# Development

Clone this repository:

```sh
git clone https://github.com/khanghuynh92/leflair-code-challenge
```

## Fronend

```sh
cd frontend
```

Install dependencies:

```sh
yarn
```

Start the project at [`http://localhost:3000`](http://localhost:3000).

```sh
yarn start
```

## Backend

```bash
$ cd backend
```

Install dependencies:

```sh
yarn
```

Start the project at [`http://localhost:9000`](http://localhost:9000).

```sh
$ yarn start
```

Running unit tests

```sh
$ yarn test
```

Linting code

```sh
$ yarn lint
```

# Running with Docker
Update client proxy in client/package.json:

![](./images/client-proxy.png)


Start via:

```
docker-compose up

# or detached
docker-compose up -d
```

Run a container of the server image via:

```
docker-compose run server /bin/bash
```

Check status:

```
docker-compose ps
```

Stop:

```
docker-compose down
```

Run the production:

```
docker-compose -f docker-compose.prod.yml up
```

Run the server side rendering production:

```
docker-compose -f docker-compose.ssr-prod.yml up
```

NOTE: if any dependencies change in package.json files, you probably will need to rebuild the container for the changes to appear, e.g.,

```
docker-compose down
docker-compose build
docker-compose up
```


# Deploy to heroku

```bash
git clone https://github.com/khanghuynh92/leflair-code-challenge.git
cd leflair-code-challenge
heroku login (enter your credentials)
heroku create <YOUR_APP_NAME>
heroku buildpacks:set https://github.com/heroku/heroku-buildpack-nodejs#yarn
heroku config:set MONGO_URL=<MONGO_URL>

git push heroku master
heroku open
```
